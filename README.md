Forked From Litian's work, used as the base architecture
